{% extends "authentication/base.html" %}
{% load static %}
{% block title %} Create Account {% endblock %}
{% block content %}
  <div class="flex justify-center font-poppins">
        <div class="w-full px-6 py-10 lg:px-8">
            <div class="max-w-4xl mx-auto">
                <!-- <div class=" z-20 relative flex items-center gap-4 mb-6">
                  <img src="{% static 'images/mcetlogo.png' %}" class="w-[75px]">
                  <p class="text-xl font-bold mt-4">Dr.Mahalingam College of Engineering and Technology</p>
                </div> -->
            </div>
          <div class="max-w-2xl mx-auto">
                            <p class="text-xl font-poppins font-bold">Create your Account</p>
                <p class=" text-gray-600">
                  Already have an account?
                  <a href="{% if request.GET.next %}{% url 'signin'%}?next={{request.GET.next}}{% else %} {% url 'signin'%} {% endif %}" class="font-semibold text-[#D4AF37] hover:text-[#C2A34E]">Sign in</a>
                </p>
                <p class="errortext text-red-500 mt-4 text-sm font-medium">{{errortext}}</p>
            <div class="transition-all flex gap-2 mt-4 bg-gray-100 p-1 rounded-md shadow-inner">
                  <button value="student" class="formselector stubtn w-full rounded-md bg-[#D4AF37] text-black px-3 py-2     font-semibold shadow-sm transition-all">Student</button>
                  <button value="staff" class="formselector stfbtn w-full rounded-md bg-transparent text-gray-600 px-3 py-2 font-semibold transition-all">Faculty</button>
                </div>
            <form class="space-y-6 form studentform" method="POST" enctype="multipart/form-data">
              {% csrf_token %}
              <div>
                  <label for="business_name" class="block text-sm font-medium text-gray-800 mb-2">Student Name</label>
                  <input id="business_name" name="fullname" type="text" autocomplete="business_name" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
              </div>
  
              <div>
                <label for="roll" class="block text-sm font-medium text-gray-800 mb-2">Student Register Number</label>
                <input id="roll" name="roll" type="text" required class="rollno block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
              </div>

              <div>
                <label for="department" class="block text-sm font-medium text-gray-800 mb-2">Department</label>
                <select name="department" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
                  <option selected disabled>Please Select</option>
                    {% for department in departments %}
                        <option value="{{department.id}}">{{department}}</option>
                    {% endfor %}
                </select>
              </div>

              <div>
                <label for="yos" class="block text-sm font-medium text-gray-800 mb-2">Year of Study</label>
                <select name="yos" id="yos" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
                    <option value="">Please Select</option>
                    <option value="FIRST">First Year</option>
                    <option value="SECOND">Second Year</option>
                    <option value="THIRD">Third Year</option>
                    <option value="FINAL">Final Year</option>
                </select>
              </div>
              <div>
                  <label for="pmail" class="block text-sm font-medium text-gray-800 mb-2">Email Address</label>
                  <input id="pmail" name="personalmail" type="email" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
                  <p class="text-sm text-gray-500 flex items-center gap-1 mt-2">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 opacity-70"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                      Will be used for verification purposes
                  </p>
              </div>

              <div>
                  <label for="contact" class="block text-sm font-medium text-gray-800 mb-2">Contact Number</label>
                  <input id="contact" name="contact" type="tel" minlength="10" maxlength="10" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
              </div>
              <!-- <div class="border-t border-gray-200 pt-6">
                  <p class="text-sm font-medium text-gray-800 mb-3">Are you a Research Scholar?</p>
                  <div class="flex items-center gap-6">
                      <div class="flex items-center">
                          <input id="inline-radio" type="radio" value="rsh_sch" name="usertype" class="w-4 h-4 text-[#D4AF37] bg-gray-100 border-gray-300 focus:ring-[#D4AF37]">
                          <label for="inline-radio" class="ml-2 block text-sm text-gray-800">Yes</label>
                      </div>
                      <div class="flex items-center">
                          <input id="inline-2-radio" type="radio" value="student" checked name="usertype" class="w-4 h-4 text-[#D4AF37] bg-gray-100 border-gray-300 focus:ring-[#D4AF37]">
                          <label for="inline-2-radio" class="ml-2 block text-sm text-gray-800">No</label>
                      </div>
                  </div>
              </div> -->

              <div>
                  <label for="password" class="block text-sm font-medium text-gray-800 mb-2">Password</label>
                  <input id="password" name="password1" type="password" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
              </div>
  
              <div>
                  <label for="password2" class="block text-sm font-medium text-gray-800 mb-2">Re-Enter Password</label>
                  <input id="password2" name="password2" type="password" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
              </div>

              <div class="border-t border-gray-200 pt-6">
                <label for="id_profile_photo" class="block text-sm font-medium text-gray-800 mb-2">Profile Photo</label>
                <input type="file" name="profile_photo" id="id_profile_photo" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-gray-100 file:text-gray-800 hover:file:bg-gray-200 transition-colors">
              </div>
        
              <div class="border-t border-gray-200 pt-6">
                <button type="submit" class="flex w-full justify-center rounded-md bg-[#D4AF37] px-6 py-2 font-semibold text-black shadow-md hover:bg-[#C2A34E] transition-all">Create Account</button>
              </div>
            </form>

            <form class="space-y-6 form staffform hidden" method="POST" enctype="multipart/form-data">
              {% csrf_token %}
              <input type="text" name="usertype" value="faculty" class="hidden">
              <div>
                  <label for="staff_name" class="block text-sm font-medium text-gray-800 mb-2">Staff Name</label>
                  <input id="staff_name" name="fullname" type="text" autocomplete="name" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
              </div>
              <div>
                <label for="designation" class="block text-sm font-medium text-gray-800 mb-2">Designation</label>
                <select name="designation" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
                  <option selected disabled>Please Select</option>
                    {% for designation in staffdesignations %}
                        <option value="{{designation.id}}">{{designation}}</option>
                    {% endfor %}
                </select>
              </div>

              <div>
                  <label for="staff_email" class="block text-sm font-medium text-gray-800 mb-2">Email Address</label>
                  <input id="staff_email" name="personalmail" type="email" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
                  <p class="text-sm text-gray-500 flex items-center gap-1 mt-2">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 opacity-70"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                      Will be used for verification purposes
                  </p>
              </div>

              <div>
                  <label for="staff_contact" class="block text-sm font-medium text-gray-800 mb-2">Contact Number</label>
                  <input id="staff_contact" name="contact" type="tel" minlength="10" maxlength="10" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
              </div>

              <div>
                <label for="staff_department" class="block text-sm font-medium text-gray-800 mb-2">Department</label>
                <select name="department" id="staff_department" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
                    {% for department in departments %}
                        <option value="{{department.id}}">{{department}}</option>
                    {% endfor %}
                </select>
              </div>

              <div>
                  <label for="staff_password1" class="block text-sm font-medium text-gray-800 mb-2">Password</label>
                  <input id="staff_password1" name="password1" type="password" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
              </div>
  
              <div>
                  <label for="staff_password2" class="block text-sm font-medium text-gray-800 mb-2">Re-Enter Password</label>
                  <input id="staff_password2" name="password2" type="password" required class="block w-full rounded-md border-gray-300 shadow-sm focus:border-[#D4AF37] focus:ring focus:ring-[#D4AF37] focus:ring-opacity-50 py-2 px-3">
              </div>

              <div class="border-t border-gray-200 pt-6">
                <label for="staff_profile_photo" class="block text-sm font-medium text-gray-800 mb-2">Profile Photo</label>
                <input type="file" name="profile_photo" id="staff_profile_photo" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-gray-100 file:text-gray-800 hover:file:bg-gray-200 transition-colors">
              </div>
        
              <div class="border-t border-gray-200 pt-6">
                <button type="submit" class="flex w-full justify-center px-6 py-2 rounded-md bg-[#D4AF37] text-sm font-semibold text-black shadow-md hover:bg-[#C2A34E] transition-all">
                  Create Account
                </button>
              </div>
            </form>
        
            <p class="mt-2 text-center text-gray-500">
              Already have an account?
              <a href="{% if request.GET.next %}{% url 'signin'%}?next={{request.GET.next}}{% else %} {% url 'signin'%}  {% endif %}" class="font-semibold leading-6 text-[#D4AF37] hover:text-[#a7871d]">Signin</a>
            </p>
          </div>
        </div>
        <!-- Side banner -->
        <!-- <div class="flex max-h-full lg:max-w-[50%] justify-center ">
          <img src="{% static 'images/signinpg.jpg' %}" class="md:max-h-[70%]" alt="banner">
        </div> -->
      </div>
{% endblock %}
{% block script %}
      <script src="
https://cdn.jsdelivr.net/npm/algoliasearch@5.28.0/dist/algoliasearch.umd.min.js
"></script>

      <script>
        const regex = /7276[1-9]{2}[A-Za-z]+[0-9]{3}/
        const errtxt = document.querySelector('.errortext')
        const form  = document.querySelector('.form')
        const clginput  = document.querySelector('.college')
        const clgautocomp  = document.querySelector('#colleges')
        const formselector  = document.querySelectorAll('.formselector')
        // const district  = document.querySelector('#district')

        // const ags = algoliasearch("0OGJK8WZ1S", "8af42e8ffd62134984f19332df25448d")
    
        // agind = agsclient.initIndex("College")
        formselector.forEach(e=>{
          e.addEventListener('click', changeForm)
        })

        function changeForm(e)
        {
          if (e.target.value === "staff")
          {
            document.querySelector('.studentform').style.display = 'none'
            document.querySelector('.staffform').style.display = 'block'

            document.querySelector('.stubtn').style.background = "transparent"
            document.querySelector('.stubtn').style.color = "black"

            document.querySelector('.stfbtn').style.background = "#D4AF37"
            document.querySelector('.stfbtn').style.color = "white"
          } 
          else if (e.target.value === "student")
          {
            document.querySelector('.studentform').style.display = 'block'
            document.querySelector('.staffform').style.display = 'none'

            document.querySelector('.stfbtn').style.background = "transparent"
            document.querySelector('.stfbtn').style.color = "black"

            document.querySelector('.stubtn').style.background = "#D4AF37"
            document.querySelector('.stubtn').style.color = "white"
          }
        }

        function changeInput(e) {
          colleges.innerHTML = ''
          ins.college = e.target.innerText
          ins.dist = e.target.getAttribute('data-district')
          clginput.value = e.target.innerText
          console.log(e.target, ins)
        }


        form.addEventListener('submit', (e)=>{
            e.preventDefault()
            if (document.getElementsByName('password1')[0].value.length < 8)
            {
                errtxt.innerText = "Weak Password: Please enter a password of minimum length 8 characters in an alphanumeric combination"
            }
            else if(document.getElementsByName('password1')[0].value != document.getElementsByName('password2')[0].value)
            {
                errtxt.innerText = "Password Mismatch: Please Enter the same password in both the fields"
            }
            else
            {
                form.submit()
            }

        })
      </script>
{% endblock %}